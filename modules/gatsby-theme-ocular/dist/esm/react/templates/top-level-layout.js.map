{"version":3,"sources":["../../../../src/react/templates/top-level-layout.jsx"],"names":["React","Helmet","MediaQuery","ThemeProvider","createGlobalStyle","withPrefix","WebsiteConfigProvider","SEO","TableOfContents","Header","DocsHeader","defaultTheme","createTheme","BodyContainerFull","BodyContainerToC","Body","HeaderContainer","TocContainer","GlobalStyle","ResponsiveHeader","props","HeaderComponent","isDocHeader","Layout","state","isMenuOpen","isTocOpen","prevProps","pageContext","slug","setState","config","primitives","Object","assign","THEME_OVERRIDES","JSON","parse","on","tableOfContents","children","toggleToc","bind","toggleMenu","renderTOC","cloneElement","toc","chapters","Array","isArray","Error","path","theme","getTheme","title","PROJECT_NAME","STYLESHEETS","map","url","i","renderBodyWithTOC","renderBodyFull","Component"],"mappings":"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","sourcesContent":["/* eslint-disable react/no-did-update-set-state */\n// This is the top-level \"Layout\" component that doesn't get unmounted between\n// page loads. This component is wrapped around the react component returned by\n// each page by 'gatsby-plugin-layout'\n\nimport React from 'react';\nimport Helmet from 'react-helmet';\nimport MediaQuery from 'react-responsive';\nimport {ThemeProvider, createGlobalStyle} from 'styled-components';\nimport {withPrefix} from 'gatsby';\n\nimport {WebsiteConfigProvider} from '../components/website-config';\nimport SEO from '../components/SEO';\nimport TableOfContents from '../components/table-of-contents';\nimport Header from '../components/header';\nimport DocsHeader from '../components/docs-header';\n\nimport defaultTheme from '../default-theme';\nimport createTheme from '../styled/create-theme';\n\nimport {BodyContainerFull, BodyContainerToC, Body} from '../styled/body';\n\nimport {HeaderContainer} from '../styled/header';\nimport {TocContainer} from '../styled/toc';\n\nconst GlobalStyle = createGlobalStyle`\n  body {\n    margin: 0;\n    overflow-x: hidden;\n    -webkit-text-size-adjust: 100%;\n  }\n  * {\n    box-sizing: border-box;\n  }\n`;\n\n// TODO/ib - restore footer\n// import Footer from './footer';\n\nfunction ResponsiveHeader(props) {\n  const HeaderComponent = props.isDocHeader ? DocsHeader : Header;\n  return (\n    <div>\n      <MediaQuery maxWidth={768}>\n        <HeaderComponent {...props} isSmallScreen />\n      </MediaQuery>\n      <MediaQuery minWidth={769}>\n        <HeaderComponent {...props} />\n      </MediaQuery>\n    </div>\n  );\n}\n\nexport default class Layout extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isMenuOpen: false,\n      isTocOpen: false\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.pageContext.slug !== this.props.pageContext.slug) {\n      this.setState({isTocOpen: false, isMenuOpen: false});\n    }\n  }\n\n  getTheme() {\n    const {config} = this.props;\n    const primitives = Object.assign({}, defaultTheme);\n    if (config.THEME_OVERRIDES) {\n      Object.assign(primitives, JSON.parse(config.THEME_OVERRIDES));\n    }\n\n    return createTheme(primitives);\n  }\n\n  toggleMenu(on) {\n    this.setState({isMenuOpen: on});\n  }\n\n  toggleToc(on) {\n    this.setState({isTocOpen: on});\n  }\n\n  renderBodyWithTOC(config, tableOfContents) {\n    const {children} = this.props;\n    const {isMenuOpen, isTocOpen} = this.state;\n    // first div is to avoid the BodyGrid div className to be overwritten\n    return (\n      <Body>\n        <HeaderContainer>\n          <ResponsiveHeader\n            config={config}\n            isMenuOpen={isMenuOpen}\n            isTocOpen={isTocOpen}\n            toggleToc={this.toggleToc.bind(this)}\n            toggleMenu={this.toggleMenu.bind(this)}\n            isDocHeader\n          />\n        </HeaderContainer>\n        <TocContainer $isTocOpen={isTocOpen}>{this.renderTOC(tableOfContents)}</TocContainer>\n\n        <BodyContainerToC>{React.cloneElement(children, {config: config})}</BodyContainerToC>\n        {/* <Footer /> */}\n      </Body>\n    );\n  }\n\n  renderBodyFull(config) {\n    const {children} = this.props;\n    const {isMenuOpen} = this.state;\n    return (\n      <Body>\n        <HeaderContainer>\n          <ResponsiveHeader\n            config={config}\n            isMenuOpen={isMenuOpen}\n            toggleMenu={this.toggleMenu.bind(this)}\n          />\n        </HeaderContainer>\n\n        <BodyContainerFull>{React.cloneElement(children, {config: config})}</BodyContainerFull>\n\n        {/* <Footer /> */}\n      </Body>\n    );\n  }\n\n  renderTOC(tableOfContents) {\n    const {pageContext} = this.props;\n    let toc;\n    if (pageContext.toc === 'docs') {\n      toc = tableOfContents.chapters;\n    } else {\n      toc = pageContext.toc;\n    }\n    if (!Array.isArray(toc)) {\n      throw new Error(`Unknown toc type ${pageContext.toc}`);\n    }\n\n    return <TableOfContents chapters={toc} slug={pageContext.slug} />;\n  }\n\n  render() {\n    // Since gatsby's StaticQueries can't run in a plugin, we rely on the app website's\n    // Layout wrapper component to query for us and pass in the data.\n    const {pageContext, config, tableOfContents, path} = this.props;\n\n    const theme = this.getTheme();\n    let title = config.PROJECT_NAME;\n    if (pageContext.title) {\n      title += ` | ${pageContext.title}`;\n    }\n\n    return (\n      <WebsiteConfigProvider value={{config, theme, tableOfContents}}>\n        <GlobalStyle />\n        <ThemeProvider theme={theme}>\n          <div>\n            <SEO path={path} pageContext={pageContext} config={config} />\n            <Helmet>\n              <title>{title}</title>\n              {config.STYLESHEETS.map((url, i) => {\n                return <link key={i} rel=\"stylesheet\" href={withPrefix(url)} type=\"text/css\" />;\n              })}\n              <link rel=\"icon\" type=\"img/ico\" href=\"favicon.ico\" />\n            </Helmet>\n            {pageContext.toc\n              ? this.renderBodyWithTOC(config, tableOfContents)\n              : this.renderBodyFull(config)}\n          </div>\n        </ThemeProvider>\n      </WebsiteConfigProvider>\n    );\n  }\n}\n"],"file":"top-level-layout.js"}