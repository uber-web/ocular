{"version":3,"sources":["../../../../src/react/templates/top-level-layout.jsx"],"names":["GlobalStyle","createGlobalStyle","ResponsiveHeader","props","HeaderComponent","isDocHeader","DocsHeader","Header","Layout","state","isMenuOpen","isTocOpen","prevProps","pageContext","slug","setState","config","primitives","Object","assign","defaultTheme","THEME_OVERRIDES","JSON","parse","on","tableOfContents","children","toggleToc","bind","toggleMenu","renderTOC","React","cloneElement","toc","chapters","Array","isArray","Error","path","theme","getTheme","title","PROJECT_NAME","STYLESHEETS","map","url","i","renderBodyWithTOC","renderBodyFull","Component"],"mappings":"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","sourcesContent":["/* eslint-disable react/no-did-update-set-state */\n// This is the top-level \"Layout\" component that doesn't get unmounted between\n// page loads. This component is wrapped around the react component returned by\n// each page by 'gatsby-plugin-layout'\n\nimport React from 'react';\nimport Helmet from 'react-helmet';\nimport MediaQuery from 'react-responsive';\nimport {ThemeProvider, createGlobalStyle} from 'styled-components';\nimport {withPrefix} from 'gatsby';\n\nimport {WebsiteConfigProvider} from '../components/website-config';\nimport SEO from '../components/SEO';\nimport TableOfContents from '../components/table-of-contents';\nimport Header from '../components/header';\nimport DocsHeader from '../components/docs-header';\n\nimport defaultTheme from '../default-theme';\nimport createTheme from '../styled/create-theme';\n\nimport {BodyContainerFull, BodyContainerToC, Body} from '../styled/body';\n\nimport {HeaderContainer} from '../styled/header';\nimport {TocContainer} from '../styled/toc';\n\nconst GlobalStyle = createGlobalStyle`\n  body {\n    margin: 0;\n    overflow-x: hidden;\n    -webkit-text-size-adjust: 100%;\n  }\n  * {\n    box-sizing: border-box;\n  }\n`;\n\n// TODO/ib - restore footer\n// import Footer from './footer';\n\nfunction ResponsiveHeader(props) {\n  const HeaderComponent = props.isDocHeader ? DocsHeader : Header;\n  return (\n    <div>\n      <MediaQuery maxWidth={768}>\n        <HeaderComponent {...props} isSmallScreen />\n      </MediaQuery>\n      <MediaQuery minWidth={769}>\n        <HeaderComponent {...props} />\n      </MediaQuery>\n    </div>\n  );\n}\n\nexport default class Layout extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isMenuOpen: false,\n      isTocOpen: false\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.pageContext.slug !== this.props.pageContext.slug) {\n      this.setState({isTocOpen: false, isMenuOpen: false});\n    }\n  }\n\n  getTheme() {\n    const {config} = this.props;\n    const primitives = Object.assign({}, defaultTheme);\n    if (config.THEME_OVERRIDES) {\n      Object.assign(primitives, JSON.parse(config.THEME_OVERRIDES));\n    }\n\n    return createTheme(primitives);\n  }\n\n  toggleMenu(on) {\n    this.setState({isMenuOpen: on});\n  }\n\n  toggleToc(on) {\n    this.setState({isTocOpen: on});\n  }\n\n  renderBodyWithTOC(config, tableOfContents) {\n    const {children} = this.props;\n    const {isMenuOpen, isTocOpen} = this.state;\n    // first div is to avoid the BodyGrid div className to be overwritten\n    return (\n      <Body>\n        <HeaderContainer>\n          <ResponsiveHeader\n            config={config}\n            isMenuOpen={isMenuOpen}\n            isTocOpen={isTocOpen}\n            toggleToc={this.toggleToc.bind(this)}\n            toggleMenu={this.toggleMenu.bind(this)}\n            isDocHeader\n          />\n        </HeaderContainer>\n        <TocContainer $isTocOpen={isTocOpen}>{this.renderTOC(tableOfContents)}</TocContainer>\n\n        <BodyContainerToC>{React.cloneElement(children, {config: config})}</BodyContainerToC>\n        {/* <Footer /> */}\n      </Body>\n    );\n  }\n\n  renderBodyFull(config) {\n    const {children} = this.props;\n    const {isMenuOpen} = this.state;\n    return (\n      <Body>\n        <HeaderContainer>\n          <ResponsiveHeader\n            config={config}\n            isMenuOpen={isMenuOpen}\n            toggleMenu={this.toggleMenu.bind(this)}\n          />\n        </HeaderContainer>\n\n        <BodyContainerFull>{React.cloneElement(children, {config: config})}</BodyContainerFull>\n\n        {/* <Footer /> */}\n      </Body>\n    );\n  }\n\n  renderTOC(tableOfContents) {\n    const {pageContext} = this.props;\n    let toc;\n    if (pageContext.toc === 'docs') {\n      toc = tableOfContents.chapters;\n    } else {\n      toc = pageContext.toc;\n    }\n    if (!Array.isArray(toc)) {\n      throw new Error(`Unknown toc type ${pageContext.toc}`);\n    }\n\n    return <TableOfContents chapters={toc} slug={pageContext.slug} />;\n  }\n\n  render() {\n    // Since gatsby's StaticQueries can't run in a plugin, we rely on the app website's\n    // Layout wrapper component to query for us and pass in the data.\n    const {pageContext, config, tableOfContents, path} = this.props;\n\n    const theme = this.getTheme();\n    let title = config.PROJECT_NAME;\n    if (pageContext.title) {\n      title += ` | ${pageContext.title}`;\n    }\n\n    return (\n      <WebsiteConfigProvider value={{config, theme, tableOfContents}}>\n        <GlobalStyle />\n        <ThemeProvider theme={theme}>\n          <div>\n            <SEO path={path} pageContext={pageContext} config={config} />\n            <Helmet>\n              <title>{title}</title>\n              {config.STYLESHEETS.map((url, i) => {\n                return <link key={i} rel=\"stylesheet\" href={withPrefix(url)} type=\"text/css\" />;\n              })}\n              <link rel=\"icon\" type=\"img/ico\" href=\"favicon.ico\" />\n            </Helmet>\n            {pageContext.toc\n              ? this.renderBodyWithTOC(config, tableOfContents)\n              : this.renderBodyFull(config)}\n          </div>\n        </ThemeProvider>\n      </WebsiteConfigProvider>\n    );\n  }\n}\n"],"file":"top-level-layout.js"}