{"version":3,"sources":["../../../src/configuration/get-webpack-config.js"],"names":["require","resolve","BundleAnalyzerPlugin","HtmlWebpackPlugin","getOcularConfig","COMMON_CONFIG","mode","devServer","stats","warnings","devtool","module","rules","test","use","enforce","node","fs","net","child_process","plugins","MAIN_FIELDS","es6","esm","es5","exports","getWebpackConfig","env","opts","config","alias","aliases","Object","assign","entry","getEntryPoints","mainFields","dist","entryKey","key"],"mappings":"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","sourcesContent":["/** @typedef {import('./get-webpack-config')} types */\n\nconst {resolve} = require('path');\nconst BundleAnalyzerPlugin = null; // require('webpack-bundle-analyzer').BundleAnalyzerPlugin;\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\nconst {getOcularConfig} = require('../helpers/get-ocular-config');\n\nconst COMMON_CONFIG = {\n  mode: 'development',\n\n  devServer: {\n    stats: {\n      warnings: false\n    }\n  },\n\n  resolve: {},\n\n  devtool: 'inline-source-maps',\n\n  module: {\n    rules: [\n      {\n        // Unfortunately, webpack doesn't import library sourcemaps on its own...\n        test: /\\.js$/,\n        use: ['source-map-loader'],\n        enforce: 'pre'\n      }\n    ]\n  },\n\n  node: {\n    fs: 'empty',\n    net: 'empty',\n    // eslint-disable-next-line camelcase\n    child_process: 'empty'\n  },\n\n  plugins: [new HtmlWebpackPlugin()]\n};\n\nconst MAIN_FIELDS = {\n  es6: ['esnext', 'browser', 'module', 'main'],\n  esm: ['module', 'main'],\n  es5: ['main']\n};\n\n/** @type {types['getWebpackConfig']} */\nmodule.exports.getWebpackConfig = function getWebpackConfig(env = {}, opts = {}) {\n  const config = getOcularConfig(opts);\n\n  COMMON_CONFIG.resolve.alias = config.aliases;\n\n  switch (env.mode) {\n    case 'size':\n      return Object.assign({}, COMMON_CONFIG, {\n        mode: 'production',\n\n        entry: getEntryPoints('size', config),\n\n        resolve: Object.assign({}, COMMON_CONFIG.resolve, {\n          mainFields: MAIN_FIELDS[env.dist] || MAIN_FIELDS.esm\n        }),\n\n        devtool: false,\n\n        plugins: []\n      });\n\n    case 'analyze':\n    case 'analyze-dev':\n      return Object.assign({}, COMMON_CONFIG, {\n        mode: 'development',\n\n        entry: getEntryPoints('size', config),\n\n        devtool: false,\n\n        plugins: [new BundleAnalyzerPlugin()]\n      });\n\n    case 'analyze-prod':\n      return Object.assign({}, COMMON_CONFIG, {\n        mode: 'production',\n\n        entry: getEntryPoints('size', config),\n\n        devtool: false,\n\n        plugins: [new BundleAnalyzerPlugin()]\n      });\n\n    case 'bench':\n    case 'test':\n    default:\n      return Object.assign({}, COMMON_CONFIG, {\n        entry: getEntryPoints(`${env.mode}-browser`, config)\n      });\n  }\n};\n\n// HELPERS\n\nfunction getEntryPoints(entryKey, config) {\n  let entry = config.entry[entryKey] || {};\n  if (typeof entry === 'string') {\n    entry = {[entryKey]: entry};\n  }\n  for (const key in entry) {\n    entry[key] = resolve(entry[key]);\n  }\n  return entry;\n}\n"],"file":"get-webpack-config.js"}